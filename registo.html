<!doctype html>
<html lang="pt-PT">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>HealthSupply - Registo de Empresa</title>
    <link rel="shortcut icon" href="imagens/hs_logo.ico" type="image/x-icon" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.19/css/intlTelInput.css"
    />
    <link rel="stylesheet" href="css/styles.css" />
  </head>
  <body>
    <nav class="navbar navbar-expand-lg position-fixed sticky-top w-100">
      <div class="container-fluid justify-content-start col-12 col-md-8 gap-3">
        <a
          href="index.html"
          class="back-btn text-black text-decoration-none d-flex align-items-center gap-2 py-2 px-3 rounded"
          ><svg
            xmlns="http://www.w3.org/2000/svg"
            width="16"
            height="16"
            fill="currentColor"
            class="bi bi-arrow-left"
            viewBox="0 0 16 16"
          >
            <path
              fill-rule="evenodd"
              d="M15 8a.5.5 0 0 1-.5.5H2.707l3.147 3.146a.5.5 0 0 1-.708.708l-4-4a.5.5 0 0 1 0-.708l4-4a.5.5 0 1 1 .708.708L2.707 7.5H14.5A.5.5 0 0 1 15 8z"
            />
          </svg>
          Voltar</a
        >
        <a class="navbar-brand" href="#"
          ><img src="imagens/hs_logo.png" alt="HealthSupply Logo"
        /></a>
      </div>
    </nav>

    <section id="registo" class="py-5 mt-5">
      <div class="mb-4 col-10 col-md-12 m-auto">
        <h2 class="text-center">Registo de Empresa</h2>
        <p class="text-center text-light">
          Preencha o formulário abaixo para registar a sua empresa na nossa
          plataforma.
        </p>
      </div>

      <form
        id="registoForm"
        class="d-flex flex-column gap-4 needs-validation col-10 col-lg-7 m-auto"
        novalidate
      >
        <div
          class="d-flex flex-column bg-white p-4 rounded-4 gap-2 border shadow-sm"
        >
          <div class="d-flex gap-2 align-items-center mb-3">
            <div class="item-icon-06 rounded-3">
              <svg
                id="Layer_1"
                viewBox="0 0 24 24"
                width="18"
                height="18"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="m4 13h3v2h-3zm5 2h3v-2h-3zm-5 4h3v-2h-3zm5 0h3v-2h-3zm-5-12h3v-2h-3zm5 0h3v-2h-3zm-5 4h3v-2h-3zm5 0h3v-2h-3zm15-3v16h-24v-21a3 3 0 0 1 3-3h10a3 3 0 0 1 3 3v2h5a3 3 0 0 1 3 3zm-10-5a1 1 0 0 0 -1-1h-10a1 1 0 0 0 -1 1v19h12zm8 5a1 1 0 0 0 -1-1h-5v15h6zm-4 7h2v-2h-2zm0 4h2v-2h-2zm0-8h2v-2h-2z"
                />
              </svg>
            </div>
            <div class="d-flex flex-column">
              <h6 class="m-0">Perfil da Empresa</h6>
              <p class="text-light text-xs mb-0">Selecione o tipo de perfil</p>
            </div>
          </div>

          <div
            id="perfilGroup"
            class="d-flex gap-3 flex-column flex-md-row position-relative"
          >
            <label
              class="card p-3 flex-fill cursor-pointer card-radio rounded-4"
            >
              <input
                type="radio"
                name="perfil"
                value="compradora"
                class="visually-hidden"
                required
              />
              <div class="card-content">
                <h6 class="mb-1 text-center">Compradora</h6>
              </div>
            </label>

            <label
              class="card p-3 flex-fill cursor-pointer card-radio rounded-4"
            >
              <input
                type="radio"
                name="perfil"
                value="fornecedora"
                class="visually-hidden"
              />
              <div class="card-content">
                <h6 class="mb-1 text-center">Fornecedora</h6>
              </div>
            </label>
          </div>
          <div class="invalid-feedback mt-1">
            Por favor selecione o tipo de perfil da empresa.
          </div>
        </div>

        <div
          id="categoriaContainer"
          class="d-flex flex-column bg-white p-4 rounded-4 gap-2 border shadow-sm d-none"
        >
          <div class="d-flex gap-2 align-items-center mb-3">
            <div class="item-icon-06 rounded-3">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                id="Layer_1"
                data-name="Layer 1"
                viewBox="0 0 24 24"
                width="18"
                height="18"
              >
                <path
                  d="M23.621,6.836l-1.352-2.826c-.349-.73-.99-1.296-1.758-1.552L14.214,.359c-1.428-.476-3-.476-4.428,0L3.49,2.458c-.769,.256-1.41,.823-1.759,1.554L.445,6.719c-.477,.792-.567,1.742-.247,2.609,.309,.84,.964,1.49,1.802,1.796l-.005,6.314c-.002,2.158,1.372,4.066,3.418,4.748l4.365,1.455c.714,.238,1.464,.357,2.214,.357s1.5-.119,2.214-.357l4.369-1.457c2.043-.681,3.417-2.585,3.419-4.739l.005-6.32c.846-.297,1.508-.946,1.819-1.79,.317-.858,.228-1.799-.198-2.499ZM10.419,2.257c1.02-.34,2.143-.34,3.162,0l4.248,1.416-5.822,1.95-5.834-1.95,4.246-1.415ZM2.204,7.666l1.327-2.782c.048,.025,7.057,2.373,7.057,2.373l-1.621,3.258c-.239,.398-.735,.582-1.173,.434l-5.081-1.693c-.297-.099-.53-.325-.639-.619-.109-.294-.078-.616,.129-.97Zm3.841,12.623c-1.228-.409-2.052-1.554-2.051-2.848l.005-5.648,3.162,1.054c1.344,.448,2.792-.087,3.559-1.371l.278-.557-.005,10.981c-.197-.04-.391-.091-.581-.155l-4.366-1.455Zm11.897-.001l-4.37,1.457c-.19,.063-.384,.115-.581,.155l.005-10.995,.319,.64c.556,.928,1.532,1.459,2.561,1.459,.319,0,.643-.051,.96-.157l3.161-1.053-.005,5.651c0,1.292-.826,2.435-2.052,2.844Zm4-11.644c-.105,.285-.331,.504-.619,.6l-5.118,1.706c-.438,.147-.934-.035-1.136-.365l-1.655-3.323s7.006-2.351,7.054-2.377l1.393,2.901c.157,.261,.186,.574,.081,.859Z"
                />
              </svg>
            </div>
            <div class="d-flex flex-column">
              <h6 class="m-0">Categoria de Produto</h6>
              <p class="text-light text-xs mb-0">
                Selecione as categorias que fornece
              </p>
            </div>
          </div>

          <div class="w-100">
            <select
              id="categorias"
              name="categorias"
              class="form-select"
              multiple
              required
            >
              <option value="todos">Todos</option>
              <option value="alimentacao_bebidas">Alimentação e Bebidas</option>
              <option value="construcao_manutencao">
                Construção e Manutenção
              </option>
              <option value="opme">
                Dispositivos Médicos Implantáveis (OPME)
              </option>
              <option value="epi">
                Equipamentos de Proteção Individual (EPI)
              </option>
              <option value="gases_medicinais">Gases Medicinais</option>
              <option value="higiene_limpeza">Higiene e Limpeza</option>
              <option value="hotelaria_lavandaria_cozinha">
                Hotelaria, Lavandaria e Cozinha
              </option>
              <option value="laboratorio_radiologia">
                Laboratório e Radiologia
              </option>
              <option value="material_descartavel">
                Material Descartável Hospitalar
              </option>
              <option value="expediente_informatica">
                Material de Expediente e Informática
              </option>
              <option value="medicamentos_solucoes">
                Medicamentos e Soluções Terapêuticas
              </option>
              <option value="mobiliario_utensilios">
                Mobiliário e Utensílios Diversos
              </option>
              <option value="nutricao_hospitalar">Nutrição Hospitalar</option>
              <option value="odontologia">Odontologia</option>
              <option value="servicos">Serviços</option>
              <option value="suprimentos_equipamentos">
                Suprimentos e Equipamentos Diversos
              </option>
              <option value="veiculos_motores">Veículos e Motores</option>
              <option value="veterinaria">Veterinária</option>
              <option value="viagens_passagens">Viagens e Passagens</option>
              <option value="outros">Outros</option>
            </select>
            <div class="invalid-feedback mt-1">
              Por favor selecione a categoria de produto.
            </div>
          </div>
        </div>

        <div
          class="d-flex flex-column bg-white p-4 rounded-4 gap-md-2 gap-0 border shadow-sm"
        >
          <div class="d-flex gap-2 align-items-center mb-3">
            <div class="item-icon-06 rounded-3">
              <svg
                id="Layer_1"
                viewBox="0 0 24 24"
                width="18"
                height="18"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="m17 14a1 1 0 0 1 -1 1h-8a1 1 0 0 1 0-2h8a1 1 0 0 1 1 1zm-4 3h-5a1 1 0 0 0 0 2h5a1 1 0 0 0 0-2zm9-6.515v8.515a5.006 5.006 0 0 1 -5 5h-10a5.006 5.006 0 0 1 -5-5v-14a5.006 5.006 0 0 1 5-5h4.515a6.958 6.958 0 0 1 4.95 2.05l3.484 3.486a6.951 6.951 0 0 1 2.051 4.949zm-6.949-7.021a5.01 5.01 0 0 0 -1.051-.78v4.316a1 1 0 0 0 1 1h4.316a4.983 4.983 0 0 0 -.781-1.05zm4.949 7.021c0-.165-.032-.323-.047-.485h-4.953a3 3 0 0 1 -3-3v-4.953c-.162-.015-.321-.047-.485-.047h-4.515a3 3 0 0 0 -3 3v14a3 3 0 0 0 3 3h10a3 3 0 0 0 3-3z"
                />
              </svg>
            </div>
            <div class="d-flex flex-column">
              <h6 class="m-0">Informações da Empresa</h6>
              <p class="text-light text-xs mb-0">Dados legais e fiscais</p>
            </div>
          </div>

          <div class="d-flex flex-column flex-md-row gap-md-3 gap-0">
            <div class="mb-3 w-100">
              <label for="nomeComercial" class="form-label"
                >Nome Comercial *</label
              >
              <input
                type="text"
                class="form-control"
                id="nomeComercial"
                name="nomeComercial"
                placeholder="Nome Comercial da Empresa"
                maxlength="200"
                required
              />
              <div class="invalid-feedback mt-1">
                Por favor preencha o nome comercial.
              </div>
            </div>
            <div class="mb-3 w-100">
              <label for="denominacaoSocial" class="form-label"
                >Denominação Social *</label
              >
              <input
                type="text"
                class="form-control"
                id="denominacaoSocial"
                name="denominacaoSocial"
                placeholder="Denominação Social da Empresa"
                maxlength="200"
                required
              />
              <div class="invalid-feedback mt-1">
                Por favor preencha a denominação social.
              </div>
            </div>
          </div>

          <div>
            <div class="mb-3 w-100">
              <label for="nipc" class="form-label">NIPC *</label>
              <input
                type="text"
                class="form-control"
                id="nipc"
                name="nipc"
                placeholder="Número de Identificação de Pessoa Colectiva"
                maxlength="9"
                inputmode="numeric"
                pattern="\d*"
                required
              />
              <div class="invalid-feedback mt-1">
                Por favor preencha o NIPC.
              </div>
            </div>
          </div>

          <div class="d-flex flex-column flex-md-row gap-md-3 gap-0">
            <div class="mb-3 w-100">
              <label for="emailGeral" class="form-label"
                >Endereço de Email Geral *</label
              >
              <input
                type="email"
                class="form-control"
                id="emailGeral"
                name="emailGeral"
                placeholder="email@geral.com"
                maxlength="200"
                required
              />
              <div class="invalid-feedback mt-1">
                Por favor preencha o endereço de email geral.
              </div>
            </div>
            <div class="mb-3 w-100">
              <label for="telefoneGeral" class="form-label"
                >Contacto Telefónico Geral *</label
              >
              <input
                type="tel"
                class="form-control"
                id="telefoneGeral"
                required
              />
              <input
                type="hidden"
                id="telefoneGeralCompleto"
                name="telefoneGeral"
              />

              <div class="invalid-feedback mt-1">
                Por favor preencha o contacto telefónico geral.
              </div>
            </div>
          </div>
        </div>

        <div
          class="d-flex flex-column bg-white p-4 rounded-4 gap-md-2 gap-0 border shadow-sm"
        >
          <div class="d-flex gap-2 align-items-center mb-3">
            <div class="item-icon-06 rounded-3">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                id="Outline"
                viewBox="0 0 24 24"
                width="18"
                height="18"
              >
                <path
                  d="M12,6a4,4,0,1,0,4,4A4,4,0,0,0,12,6Zm0,6a2,2,0,1,1,2-2A2,2,0,0,1,12,12Z"
                />
                <path
                  d="M12,24a5.271,5.271,0,0,1-4.311-2.2c-3.811-5.257-5.744-9.209-5.744-11.747a10.055,10.055,0,0,1,20.11,0c0,2.538-1.933,6.49-5.744,11.747A5.271,5.271,0,0,1,12,24ZM12,2.181a7.883,7.883,0,0,0-7.874,7.874c0,2.01,1.893,5.727,5.329,10.466a3.145,3.145,0,0,0,5.09,0c3.436-4.739,5.329-8.456,5.329-10.466A7.883,7.883,0,0,0,12,2.181Z"
                />
              </svg>
            </div>
            <div class="d-flex flex-column">
              <h6 class="m-0">Morada da Sede</h6>
              <p class="text-light text-xs mb-0">Endereço oficial da empresa</p>
            </div>
          </div>

          <div class="d-flex flex-column flex-md-row gap-md-3 gap-0">
            <div class="mb-3 w-100">
              <label for="pais" class="form-label">País *</label>
              <select id="pais" name="pais" class="form-select" required>
              </select>
              <div class="invalid-feedback">Por favor selecione o país.</div>
            </div>

            <div class="mb-3 w-100">
              <label for="codigoPostal" class="form-label"
                >Código Postal *</label
              >
              <input
                type="text"
                class="form-control"
                id="codigoPostal"
                name="codigoPostal"
                placeholder="Código Postal da Sede"
                maxlength="200"
                required
              />
              <div class="invalid-feedback mt-1">
                Por favor preencha o código postal da sede.
              </div>
            </div>
          </div>

          <div class="d-flex flex-column flex-md-row gap-md-3 gap-0">
            <div class="mb-3 w-100">
              <label for="morada" class="form-label">Morada / Endereço *</label>
              <input
                type="text"
                class="form-control"
                id="morada"
                name="morada"
                placeholder="Morada / Endereço da Sede"
                maxlength="200"
                required
              />
              <div class="invalid-feedback mt-1">
                Por favor preencha a morada / endereço da sede.
              </div>
            </div>
            <div class="mb-3 w-100">
              <label for="complemento" class="form-label">Complemento</label>
              <input
                type="text"
                class="form-control"
                id="complemento"
                name="complemento"
                placeholder="Complemento da Morada / Endereço da Sede"
                maxlength="200"
              />
              <div class="invalid-feedback mt-1">
                Por favor preencha o complemento da morada / endereço da sede.
              </div>
            </div>
          </div>

          <div class="d-flex flex-column flex-md-row gap-md-3 gap-0">
            <div class="mb-3 w-100">
              <label for="cidade" class="form-label"
                >Cidade / Localidade *</label
              >
              <input
                type="text"
                class="form-control"
                id="cidade"
                name="cidade"
                placeholder="Cidade / Localidade da Sede"
                required
              />
              <div class="invalid-feedback mt-1">
                Por favor preencha a cidade / localidade da sede.
              </div>
            </div>
            <div class="mb-3 w-100">
              <label for="regiao" class="form-label"
                >Região / Estado / Distrito *</label
              >
              <input
                type="text"
                class="form-control"
                id="regiao"
                name="regiao"
                placeholder="Região / Estado / Distrito da Sede"
                maxlength="200"
                required
              />
              <div class="invalid-feedback mt-1">
                Por favor preencha a região / estado / distrito da sede.
              </div>
            </div>
          </div>
        </div>

        <div
          class="d-flex flex-column bg-white p-4 rounded-4 gap-md-2 gap-0 border shadow-sm"
        >
          <div class="d-flex gap-2 align-items-center mb-3">
            <div class="item-icon-06 rounded-3">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                id="Outline"
                viewBox="0 0 24 24"
                width="18"
                height="18"
              >
                <path
                  d="M12,12A6,6,0,1,0,6,6,6.006,6.006,0,0,0,12,12ZM12,2A4,4,0,1,1,8,6,4,4,0,0,1,12,2Z"
                />
                <path
                  d="M12,14a9.01,9.01,0,0,0-9,9,1,1,0,0,0,2,0,7,7,0,0,1,14,0,1,1,0,0,0,2,0A9.01,9.01,0,0,0,12,14Z"
                />
              </svg>
            </div>
            <div class="d-flex flex-column">
              <h6 class="m-0">Contacto Principal</h6>
              <p class="text-light text-xs mb-0">
                Dados do representante da empresa
              </p>
            </div>
          </div>

          <div class="d-flex flex-column flex-md-row gap-md-3 gap-0">
            <div class="mb-3 w-100">
              <label for="nomePrincipal" class="form-label">Nome *</label>
              <input
                type="text"
                class="form-control"
                id="nomePrincipal"
                name="nomePrincipal"
                placeholder="Nome do Contacto Principal"
                maxlength="200"
                required
              />
              <div class="invalid-feedback mt-1">
                Por favor preencha o nome do contacto principal.
              </div>
            </div>
            <div class="mb-3 w-100">
              <label for="apelidoPrincipal" class="form-label">Apelido *</label>
              <input
                type="text"
                class="form-control"
                id="apelidoPrincipal"
                name="apelidoPrincipal"
                placeholder="Apelido do Contacto Principal"
                maxlength="200"
                required
              />
              <div class="invalid-feedback mt-1">
                Por favor preencha o apelido do contacto principal.
              </div>
            </div>
          </div>

          <div class="d-flex flex-column flex-md-row gap-md-3 gap-0">
            <div class="mb-3 w-100">
              <label for="cargoFuncao" class="form-label"
                >Cargo / Função *</label
              >
              <input
                type="text"
                class="form-control"
                id="cargoFuncao"
                name="cargoFuncao"
                placeholder="Cargo ou Função do Contacto Principal"
                maxlength="200"
                required
              />
              <div class="invalid-feedback mt-1">
                Por favor preencha o cargo ou função do contacto principal.
              </div>
            </div>
            <div class="mb-3 w-100">
              <label for="telefonePrincipal" class="form-label"
                >Contacto Telefónico *</label
              >
              <input
                type="tel"
                class="form-control"
                id="telefonePrincipal"
                required
              />
              <input
                type="hidden"
                id="telefonePrincipalCompleto"
                name="telefonePrincipal"
              />
              <div class="invalid-feedback mt-1">
                Por favor preencha o contacto telefónico do contacto principal.
              </div>
            </div>
          </div>

          <div class="mb-3 w-100">
            <label for="emailPrincipal" class="form-label"
              >Endereço de Email *</label
            >
            <input
              type="email"
              class="form-control"
              id="emailPrincipal"
              name="emailPrincipal"
              placeholder="email@principal.com"
              required
            />
            <div class="invalid-feedback mt-1">
              Por favor preencha o endereço de email do contacto principal.
            </div>
          </div>
        </div>

        <div
          class="d-flex flex-column bg-white p-4 rounded-4 gap-md-2 gap-0 border shadow-sm"
        >
          <div class="d-flex gap-2 align-items-center mb-3">
            <div class="item-icon-06 rounded-3">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                id="Layer_1"
                data-name="Layer 1"
                viewBox="0 0 24 24"
                width="18"
                height="18"
              >
                <path
                  d="m19.95,5.536l-3.485-3.485c-1.322-1.322-3.08-2.05-4.95-2.05h-4.515C4.243,0,2,2.243,2,5v14c0,2.757,2.243,5,5,5h10c2.757,0,5-2.243,5-5v-8.515c0-1.87-.728-3.627-2.05-4.95Zm-1.414,1.414c.318.318.587.671.805,1.05h-4.341c-.551,0-1-.449-1-1V2.659c.379.218.733.487,1.05.805l3.485,3.485Zm1.464,12.05c0,1.654-1.346,3-3,3H7c-1.654,0-3-1.346-3-3V5c0-1.654,1.346-3,3-3h4.515c.163,0,.325.008.485.023v4.977c0,1.654,1.346,3,3,3h4.977c.015.16.023.322.023.485v8.515Zm-4.293-4.519c.391.391.391,1.023,0,1.414-.195.195-.451.293-.707.293s-.512-.098-.707-.293l-1.293-1.293v4.398c0,.552-.448,1-1,1s-1-.448-1-1v-4.398l-1.293,1.293c-.391.391-1.023.391-1.414,0s-.391-1.023,0-1.414l1.614-1.614c1.154-1.154,3.032-1.154,4.187,0l1.614,1.614Z"
                />
              </svg>
            </div>
            <div class="d-flex flex-column">
              <h6 class="m-0">Documentos de Validação</h6>
              <p class="text-light text-xs mb-0">
                Anexe documentos para comprovar e validar a empresa
              </p>
            </div>
          </div>

          <div class="d-flex flex-column gap-1">
            <h6 class="m-0">Documentos de Validação</h6>
            <p class="text-light text-xs">
              Anexe documentos para comprovar e validar a empresa
            </p>
          </div>

          <div class="text-secondary text-xs">
            <p class="mb-0">Exemplos de documentos aceites:</p>
            <ul class="ps-3">
              <li>Certidão Permanente (Obrigatória)</li>
              <li>Alvará / Licença de Atividade</li>
              <li>Certificado de Registo no Infarmed (se aplicável)</li>
            </ul>
          </div>

          <label
            for="documentos"
            class="upload-box d-flex flex-column align-items-center justify-content-center w-100 rounded-4 cursor-pointer"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="mb-2"
              style="width: 2rem; height: 2rem; color: #6c757d"
            >
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
              <polyline points="17 8 12 3 7 8"></polyline>
              <line x1="12" y1="3" x2="12" y2="15"></line>
            </svg>

            <span class="text-secondary fw-medium small"
              >Clique para anexar documentos</span
            >
            <span class="text-secondary mt-1" style="font-size: 0.75rem"
              >PDF, JPG, PNG (máx. 10MB)</span
            >

            <input
              id="documentos"
              type="file"
              name="documentos"
              accept=".pdf,.jpg,.jpeg,.png"
              class="d-none"
              multiple
            />
          </label>

          <div id="listaDocumentos" class="mt-3"></div>
        </div>

        <div
          class="d-flex align-items-center bg-white p-4 rounded-4 gap-md-2 gap-0 border shadow-sm"
        >
          <input
            type="checkbox"
            id="checkboxTermos"
            name="termos"
            class="form-check-input mt-0"
            required
          />
          <p class="mb-0 text-xs text-secondary">
            Li e aceito os
            <a
              href="#"
              class="text-tertiary link-text"
              data-bs-toggle="modal"
              data-bs-target="#modalTermos"
              >Termos de Utilização (Terms of Use)</a
            >
            da plataforma HealthSupply.
          </p>
        </div>

        <div
          class="d-flex flex-column-reverse flex-md-row justify-content-between align-items-center gap-3 gap-md-0"
        >
          <p class="text-light text-xs mb-0">
            Precisa de ajuda?
            <a
              href="https://api.whatsapp.com/send?phone=351910998075"
              target="_blank"
              class="text-primary link-text"
              >Contacte o nosso suporte</a
            >
          </p>
          <button type="submit" class="btn btn-cta">Submeter Registo</button>
        </div>
      </form>
    </section>

    <div class="modal fade" id="modalTermos" tabindex="-1">
      <div class="modal-dialog modal-xl h-screen">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Termos de Utilização</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
            ></button>
          </div>

          <div class="modal-body" style="height: 70vh">
            <iframe
              src="assets/termos.pdf"
              width="100%"
              height="100%"
              style="border: none"
            ></iframe>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal Carregamento -->
    <div class="modal fade" id="statusModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-md modal-dialog-centered">
        <div class="modal-content text-center p-4">
          <div class="modal-body">
            <div id="statusMessage">
              <div class="spinner-grow text-primary mb-3" role="status"></div>
              <p>Enviando os dados...</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal de Sucesso -->
    <div class="modal fade" id="modalSucesso" tabindex="-1">
      <div class="modal-dialog modal-md modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <div class="modal-icon">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                id="Layer_1"
                data-name="Layer 1"
                viewBox="0 0 24 24"
                width="28"
                height="28"
              >
                <path
                  d="m17.582,8.461c.573.597.555,1.547-.043,2.121l-4.605,4.424c-.668.659-1.552.989-2.438.989s-1.774-.33-2.451-.991l-1.547-1.388c-.616-.554-.667-1.502-.113-2.118.554-.615,1.5-.668,2.119-.113l1.592,1.43c.237.23.555.232.746.042l4.62-4.438c.597-.574,1.545-.557,2.121.042Zm6.418,3.539c0,6.617-5.383,12-12,12S0,18.617,0,12,5.383,0,12,0s12,5.383,12,12Zm-3,0c0-4.962-4.037-9-9-9S3,7.038,3,12s4.037,9,9,9,9-4.038,9-9Z"
                />
              </svg>
            </div>
            <h5 class="modal-title">Submetido com Sucesso!</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <p class="m-0">
              Validaremos os dados e enviaremos o seu acesso por e-mail em
              breve.
            </p>
          </div>
          <div class="w-100 d-flex justify-content-center">
            <button
              class="btn btn-primary w-100 m-3"
              onclick="fecharModalSucesso()"
            >
              Ok
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal Erro -->
    <div class="modal fade" id="modalErro" tabindex="-1">
      <div class="modal-dialog modal-md modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header border-0">
            <h5 class="modal-title text-danger">Erro ao Submeter</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <p class="m-0">
              Ocorreu um erro ao enviar os dados. Por favor tente novamente ou
              contacte o suporte.
            </p>
          </div>
          <div class="w-100 d-flex justify-content-center">
            <button class="btn btn-danger w-100 m-3" data-bs-dismiss="modal">
              Tentar novamente
            </button>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.19/js/intlTelInput.min.js"></script>

    <script>
      const SCRIPT_URL =
        "https://script.google.com/macros/s/AKfycbyFJVlc2jRvnAete1QUrDxyRden0DWrDs_KVL4n-wIg_MIDatiV--HxeO62QRtyA1Yh/exec";

      // ── Modais
      function mostrarModal(id) {
        const el = document.getElementById(id);
        el.style.display = "flex";
        el.classList.add("show");
        document.body.classList.add("modal-open");
        let bd = document.getElementById("modal-backdrop");
        if (!bd) {
          bd = document.createElement("div");
          bd.id = "modal-backdrop";
          bd.className = "modal-backdrop fade show";
          document.body.appendChild(bd);
        }
      }

      function esconderModal(id) {
        const el = document.getElementById(id);
        if (!el) return;
        el.style.display = "";
        el.classList.remove("show");
        document.body.classList.remove("modal-open");
        const bd = document.getElementById("modal-backdrop");
        if (bd) bd.remove();
      }

      // ── Estado global
      let choicesInstance = null;
      let arquivosSelecionados = [];
      let itiGeral = null;
      let itiPrincipal = null;

      // ── renderizarLista global
      function renderizarLista() {
        const lista = document.getElementById("listaDocumentos");
        if (!lista) return;
        lista.innerHTML = "";
        if (!arquivosSelecionados.length) {
          lista.innerHTML =
            "<p class='text-secondary small mb-0'>Nenhum arquivo selecionado.</p>";
          return;
        }
        arquivosSelecionados.forEach((f, i) => {
          const div = document.createElement("div");
          div.className =
            "d-flex align-items-center justify-content-between border rounded-3 p-2 mb-2 bg-light";
          div.innerHTML = `
            <div class="d-flex item-icon-07 align-items-center gap-2">
              <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="currentColor">
                <path d="m17 14a1 1 0 0 1-1 1h-8a1 1 0 0 1 0-2h8a1 1 0 0 1 1 1zm-4 3h-5a1 1 0 0 0 0 2h5a1 1 0 0 0 0-2zm9-6.515v8.515a5.006 5.006 0 0 1-5 5h-10a5.006 5.006 0 0 1-5-5v-14a5.006 5.006 0 0 1 5-5h4.515a6.958 6.958 0 0 1 4.95 2.05l3.484 3.486a6.951 6.951 0 0 1 2.051 4.949zm-6.949-7.021a5.01 5.01 0 0 0-1.051-.78v4.316a1 1 0 0 0 1 1h4.316a4.983 4.983 0 0 0-.781-1.05zm4.949 7.021c0-.165-.032-.323-.047-.485h-4.953a3 3 0 0 1-3-3v-4.953c-.162-.015-.321-.047-.485-.047h-4.515a3 3 0 0 0-3 3v14a3 3 0 0 0 3 3h10a3 3 0 0 0 3-3z"/>
              </svg>
              <span class="small">${f.name}</span>
              <span class="text-secondary" style="font-size:0.75rem">${(f.size / 1024 / 1024).toFixed(2)} MB</span>
            </div>
            <button type="button" class="btn btn-sm btn-outline-danger py-0 px-2" onclick="removerArquivo(${i})">✕</button>`;
          lista.appendChild(div);
        });
      }

      window.removerArquivo = function (i) {
        arquivosSelecionados.splice(i, 1);
        renderizarLista();
      };

      // ── Fechar modal sucesso
      window.fecharModalSucesso = function () {
        esconderModal("modalSucesso");
        const form = document.getElementById("registoForm");
        form.reset();
        form.classList.remove("was-validated");
        arquivosSelecionados = [];
        renderizarLista();
        if (choicesInstance) choicesInstance.removeActiveItems();
        document.querySelectorAll(".is-valid, .is-invalid").forEach((el) => {
          el.classList.remove("is-valid", "is-invalid");
        });
        document.getElementById("categoriaContainer").classList.add("d-none");
      };

      // ── Inicialização após carregar todos os scripts
      window.onload = function () {
        // NIPC apenas números
        document.getElementById("nipc").addEventListener("input", function () {
          this.value = this.value.replace(/\D/g, "");
        });

        // Países
        const selectPais = document.getElementById("pais");
        [
          "Portugal",
          "Brasil",
          "Espanha",
          "França",
          "Alemanha",
          "Itália",
          "Reino Unido",
          "Estados Unidos",
          "Canadá",
          "México",
          "Argentina",
          "Angola",
          "Moçambique",
          "Cabo Verde",
          "China",
          "Japão",
          "Austrália",
          "Índia",
        ].forEach((p) => {
          const o = document.createElement("option");
          o.value = o.textContent = p;
          selectPais.appendChild(o);
        });
        selectPais.insertAdjacentHTML(
          "afterbegin",
          '<option value="" disabled selected>Selecione o país</option>',
        );

        // Choices
        const categoriasEl = document.getElementById("categorias");
        choicesInstance = new Choices(categoriasEl, {
          removeItemButton: true,
          placeholder: true,
          placeholderValue: "Selecione as categorias...",
          searchPlaceholderValue: "Pesquisar...",
          itemSelectText: "",
          shouldSort: false,
        });

        // Perfil → mostrar/ocultar categorias
        const categoriaContainer =
          document.getElementById("categoriaContainer");
        document.querySelectorAll('input[name="perfil"]').forEach((r) => {
          r.addEventListener("change", function () {
            if (this.value === "fornecedora") {
              categoriaContainer.classList.remove("d-none");
              categoriasEl.required = true;
            } else {
              categoriaContainer.classList.add("d-none");
              categoriasEl.required = false;
            }
          });
        });

        // intlTelInput — atribuídos às variáveis globais
        itiGeral = window.intlTelInput(
          document.getElementById("telefoneGeral"),
          {
            initialCountry: "pt",
            preferredCountries: ["pt", "br", "es"],
            separateDialCode: true,
          },
        );
        itiPrincipal = window.intlTelInput(
          document.getElementById("telefonePrincipal"),
          {
            initialCountry: "pt",
            preferredCountries: ["pt", "br", "es"],
            separateDialCode: true,
          },
        );

        // Ficheiros — acumula sem apagar os anteriores
        const fileInput = document.getElementById("documentos");
        fileInput.addEventListener("change", () => {
          Array.from(fileInput.files).forEach((f) => {
            if (f.size > 10 * 1024 * 1024) {
              alert(
                `"${f.name}" excede o limite de 10MB e não foi adicionado.`,
              );
              return;
            }
            arquivosSelecionados.push(f);
          });
          fileInput.value = "";
          renderizarLista();
        });

        // Modais — fechar com btn-close
        document
          .querySelectorAll('[data-bs-dismiss="modal"]')
          .forEach((btn) => {
            btn.addEventListener("click", function () {
              const modal = this.closest(".modal");
              if (modal) esconderModal(modal.id);
            });
          });

        // Modal termos
        document
          .querySelectorAll('[data-bs-target="#modalTermos"]')
          .forEach((el) => {
            el.addEventListener("click", function (e) {
              e.preventDefault();
              mostrarModal("modalTermos");
            });
          });

        // ── SUBMIT
        document
          .getElementById("registoForm")
          .addEventListener("submit", async function (e) {
            e.preventDefault();

            const form = this;

            if (!form.checkValidity()) {
              form.classList.add("was-validated");
              form
                .querySelector(":invalid")
                ?.scrollIntoView({ behavior: "smooth", block: "center" });
              return;
            }

            const perfil = document.querySelector(
              'input[name="perfil"]:checked',
            )?.value;
            if (
              perfil === "fornecedora" &&
              !Array.from(categoriasEl.selectedOptions).length
            ) {
              categoriasEl.classList.add("is-invalid");
              categoriasEl.scrollIntoView({
                behavior: "smooth",
                block: "center",
              });
              return;
            }

            mostrarModal("statusModal");

            try {
              const fd = new FormData();
              fd.append("perfil", perfil || "");
              fd.append(
                "telefoneGeral",
                document.getElementById("telefoneGeral").value || "",
              );
              fd.append(
                "telefonePrincipal",
                document.getElementById("telefonePrincipal").value || "",
              );

              [
                "nomeComercial",
                "denominacaoSocial",
                "nipc",
                "emailGeral",
                "pais",
                "codigoPostal",
                "morada",
                "complemento",
                "cidade",
                "regiao",
                "nomePrincipal",
                "apelidoPrincipal",
                "cargoFuncao",
                "emailPrincipal",
              ].forEach((id) =>
                fd.append(id, document.getElementById(id)?.value || ""),
              );

              Array.from(categoriasEl.selectedOptions).forEach((o) =>
                fd.append("categorias", o.value),
              );

              for (let i = 0; i < arquivosSelecionados.length; i++) {
                const f = arquivosSelecionados[i];
                const b64 = await new Promise((res, rej) => {
                  const r = new FileReader();
                  r.onload = () => res(r.result.split(",")[1]);
                  r.onerror = rej;
                  r.readAsDataURL(f);
                });
                fd.append(`doc_name_${i}`, f.name);
                fd.append(`doc_type_${i}`, f.type);
                fd.append(`doc_data_${i}`, b64);
              }

              const resp = await fetch(SCRIPT_URL, {
                method: "POST",
                body: fd,
              });
              const result = await resp.json();

              esconderModal("statusModal");
              mostrarModal(result.success ? "modalSucesso" : "modalErro");
              if (!result.success) console.error(result.error);
            } catch (err) {
              console.error(err);
              esconderModal("statusModal");
              mostrarModal("modalErro");
            }
          });
      };
    </script>
  </body>
</html>
